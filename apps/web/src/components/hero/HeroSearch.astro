---
/**
 * HeroSearch - Hero con buscador integrado estilo CLIC
 * Versión mejorada que coincide con el diseño de referencia
 */

interface Props {
  datos: {
    static_data: {
      titulo: string;
      subtitulo?: string;
      imagenFondo?: string;
      mostrarBuscador?: boolean;
      badge?: string;
      tagline?: string;
      valueProps?: Array<{
        texto: string;
        color: string;
      }>;
    };
    toggles?: {
      mostrarOverlay?: boolean;
      centrarTexto?: boolean;
      mostrarBadge?: boolean;
    };
    styles?: {
      altura?: string;
      overlayOpacity?: number;
    };
  };
  tema?: Record<string, string>;
  baseUrl?: string;
}

const { datos, tema = {} } = Astro.props;
const { static_data, toggles = {} } = datos;
const {
  titulo,
  subtitulo,
  imagenFondo = 'https://images.unsplash.com/photo-1600047509807-ba8f99d2cdde?w=1920&h=1080&fit=crop&auto=format&q=80',
  mostrarBuscador = true,
  badge = 'Plataforma Inmobiliaria #1',
  tagline,
  valueProps = [
    { texto: 'Asesoría personalizada', color: '#3b82f6' },
    { texto: 'Experiencia local', color: '#f59e0b' },
    { texto: 'Proceso transparente', color: '#10b981' },
  ],
} = static_data;

const {
  mostrarOverlay = true,
  mostrarBadge = true,
} = toggles;

const primaryColor = tema.primary || '#f04e00';
const secondaryColor = tema.secondary || '#1a1a1a';
---

<section class="hero-section">
  <!-- Background con gradient overlay -->
  <div class="hero-background">
    {mostrarOverlay && (
      <div class="hero-overlay"></div>
    )}
    <picture>
      <source
        media="(max-width: 640px)"
        srcset={`${imagenFondo}?w=640&q=70&fit=crop&auto=format 640w, ${imagenFondo}?w=750&q=70&fit=crop&auto=format 750w`}
        sizes="100vw"
      />
      <source
        media="(max-width: 1024px)"
        srcset={`${imagenFondo}?w=1024&q=75&fit=crop&auto=format 1024w, ${imagenFondo}?w=1280&q=75&fit=crop&auto=format 1280w`}
        sizes="100vw"
      />
      <source
        media="(min-width: 1025px)"
        srcset={`${imagenFondo}?w=1536&q=80&fit=crop&auto=format 1536w, ${imagenFondo}?w=1920&q=80&fit=crop&auto=format 1920w, ${imagenFondo}?w=2560&q=80&fit=crop&auto=format 2560w`}
        sizes="100vw"
      />
      <img
        src={`${imagenFondo}?w=1920&q=80&fit=crop&auto=format`}
        alt={titulo}
        class="hero-image"
        loading="eager"
        decoding="async"
        fetchpriority="high"
        width="1920"
        height="1080"
      />
    </picture>
  </div>

  <!-- Badge flotante -->
  {mostrarBadge && badge && (
    <div class="hero-badge">
      <div class="badge-content">
        <svg class="badge-icon" fill="currentColor" viewBox="0 0 24 24">
          <path d="M22.25 12c0-1.43-.88-2.67-2.19-3.34.46-1.39.2-2.9-.81-3.91s-2.52-1.27-3.91-.81c-.66-1.31-1.91-2.19-3.34-2.19s-2.67.88-3.34 2.19c-1.39-.46-2.9-.2-3.91.81s-1.27 2.52-.81 3.91c-1.31.66-2.19 1.91-2.19 3.34s.88 2.67 2.19 3.34c-.46 1.39-.2 2.9.81 3.91s2.52 1.27 3.91.81c.66 1.31 1.91 2.19 3.34 2.19s2.67-.88 3.34-2.19c1.39.46 2.9.2 3.91-.81s1.27-2.52.81-3.91c1.31-.66 2.19-1.91 2.19-3.34zm-11.71 4.2L6.8 12.46l1.41-1.42 2.26 2.26 4.8-5.23 1.47 1.36-6.2 6.77z"/>
        </svg>
        <span class="badge-text">{badge}</span>
      </div>
    </div>
  )}

  <!-- Contenido principal -->
  <div class="hero-content">
    <div class="content-container">
      <div class="text-container">
        <!-- Títulos -->
        <h1 class="hero-title">{titulo}</h1>
        {tagline && <h2 class="hero-tagline">{tagline}</h2>}
        {subtitulo && <p class="hero-subtitle">{subtitulo}</p>}
      </div>

      <!-- Buscador mejorado -->
      {mostrarBuscador && (
        <div class="search-wrapper">
          <div class="search-container">
            <!-- Tabs de acción -->
            <div class="action-tabs">
              <button class="action-tab active">Comprar</button>
              <button class="action-tab">Alquilar</button>
            </div>

            <!-- Grid de campos -->
            <div class="search-grid">
              <!-- Fila principal -->
              <div class="field-row main-row">
                <input
                  type="text"
                  placeholder="Ubicación"
                  class="search-field location-field"
                />
                <select class="search-field">
                  <option>Tipo de propiedad</option>
                  <option>Casa</option>
                  <option>Apartamento</option>
                  <option>Villa</option>
                  <option>Penthouse</option>
                </select>
                <select class="search-field">
                  <option>Precio</option>
                  <option>Hasta $100,000</option>
                  <option>$100,000 - $250,000</option>
                  <option>$250,000 - $500,000</option>
                  <option>$500,000+</option>
                </select>
                <button class="search-btn">
                  <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                  </svg>
                  Buscar
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      <!-- Value Propositions -->
      {valueProps && valueProps.length > 0 && (
        <div class="value-props">
          {valueProps.map((prop) => (
            <div class="value-prop-item">
              <div class="prop-dot" style={`background-color: ${prop.color};`}></div>
              <span class="prop-text">{prop.texto}</span>
            </div>
          ))}
        </div>
      )}
    </div>
  </div>
</section>

<style define:vars={{ primaryColor, secondaryColor }}>
  /* Hero Section */
  .hero-section {
    position: relative;
    min-height: 75vh;
    padding: 4rem 0;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Background */
  .hero-background {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .hero-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      to right,
      rgba(0, 0, 0, 0.7) 0%,
      rgba(0, 0, 0, 0.5) 50%,
      rgba(0, 0, 0, 0.7) 100%
    );
    z-index: 10;
  }

  .hero-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Badge */
  .hero-badge {
    position: absolute;
    top: 0.75rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: 30;
  }

  .badge-content {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  .badge-icon {
    width: 1rem;
    height: 1rem;
    color: #60a5fa;
  }

  .badge-text {
    color: #e5e7eb;
    font-size: 0.875rem;
    font-weight: 500;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
  }

  /* Content */
  .hero-content {
    position: relative;
    z-index: 20;
    width: 100%;
    max-width: 1280px;
    margin: 0 auto;
    padding: 0 1rem;
  }

  .content-container {
    max-width: 80rem;
    margin: 0 auto;
  }

  .text-container {
    text-align: center;
    margin-bottom: 2.5rem;
  }

  /* Typography */
  .hero-title {
    font-size: clamp(1.875rem, 5vw, 3rem);
    font-weight: 700;
    color: white;
    margin: 0 0 1.25rem 0;
    line-height: 1.25;
  }

  .hero-tagline {
    font-size: clamp(1.25rem, 4vw, 1.875rem);
    font-weight: 700;
    color: var(--primaryColor);
    margin: 0 0 1.5rem 0;
    line-height: 1.25;
  }

  .hero-subtitle {
    font-size: clamp(1.125rem, 2.5vw, 1.25rem);
    color: rgba(255, 255, 255, 0.9);
    margin: 0 0 2.5rem 0;
    line-height: 1.625;
    max-width: 80rem;
    margin-left: auto;
    margin-right: auto;
    font-weight: 400;
  }

  /* Search Container */
  .search-wrapper {
    margin-bottom: 2rem;
  }

  .search-container {
    background: white;
    border-radius: 1rem;
    padding: 1.5rem;
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.35), 0 10px 30px rgba(0, 0, 0, 0.2);
    max-width: 56rem;
    margin: 0 auto;
  }

  /* Action Tabs */
  .action-tabs {
    display: flex;
    gap: 0;
    margin-bottom: 1rem;
    border-bottom: 2px solid #e5e7eb;
  }

  .action-tab {
    flex: 1;
    padding: 0.75rem 1rem;
    background: none;
    border: none;
    color: #6b7280;
    font-weight: 600;
    font-size: 0.95rem;
    cursor: pointer;
    transition: all 0.2s;
    border-bottom: 3px solid transparent;
    margin-bottom: -2px;
  }

  .action-tab.active {
    color: var(--primaryColor);
    border-bottom-color: var(--primaryColor);
  }

  .action-tab:hover:not(.active) {
    color: #374151;
  }

  /* Search Grid */
  .search-grid {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .field-row {
    display: grid;
    gap: 0.75rem;
  }

  .main-row {
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  }

  /* Search Fields */
  .search-field {
    padding: 1rem 1.125rem;
    border: 1.5px solid #e5e7eb;
    border-radius: 0.5rem;
    font-size: 0.95rem;
    background: #fafafa;
    color: #1f2937;
    transition: all 0.2s ease;
    outline: none;
    font-weight: 400;
  }

  .search-field:hover {
    border-color: #d1d5db;
    background: white;
  }

  .search-field:focus {
    border-color: var(--primaryColor);
    background: white;
    box-shadow: 0 0 0 3px rgba(240, 78, 0, 0.08);
  }

  .search-field::placeholder {
    color: #9ca3af;
    font-weight: 400;
  }

  /* Search Button */
  .search-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.875rem 1.5rem;
    background: var(--primaryColor);
    color: white;
    border: none;
    border-radius: 0.5rem;
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 4px 12px rgba(240, 78, 0, 0.3);
    white-space: nowrap;
  }

  .search-btn:hover {
    background: #d64500;
    transform: translateY(-1px);
    box-shadow: 0 6px 16px rgba(240, 78, 0, 0.4);
  }

  .search-btn:active {
    transform: translateY(0);
  }

  .search-icon {
    width: 1.25rem;
    height: 1.25rem;
  }

  /* Value Props */
  .value-props {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
    gap: 2rem;
    text-align: center;
  }

  .value-prop-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .prop-dot {
    width: 0.5rem;
    height: 0.5rem;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .prop-text {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.875rem;
    font-weight: 500;
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .main-row {
      grid-template-columns: 1fr;
    }

    .search-btn {
      padding: 1rem;
    }
  }

  @media (max-width: 768px) {
    .hero-section {
      padding: 3rem 0;
    }

    .search-container {
      padding: 1rem;
    }

    .action-tab {
      font-size: 0.875rem;
      padding: 0.625rem 0.75rem;
    }

    .value-props {
      gap: 1.5rem;
    }
  }

  @media (max-width: 640px) {
    .hero-badge {
      top: 0.5rem;
    }

    .badge-text {
      font-size: 0.75rem;
    }

    .value-props {
      flex-direction: column;
      gap: 1rem;
    }
  }
</style>
